#!/usr/bin/env node

var commander = require('commander');
var lib = require('../lib.js');

commander
	.option('-b, --baseurl <url>', 'base url of web app')
	.option('-p, --public <folder>', 'location of public folder relative to root')
	.option('-l, --libs <folder>', 'location of folder containing libraries relative to public folder')
	.option('-t, --tests <folder>', 'location of tests folder relative to public folder')
	.option('-s, --scripts <folder>', 'location of application specific scripts folder relative to public folder')
	.option('-r, --reports <folder>', 'location of reports folder relative to public folder')
	.parse(process.argv);

var public = commander['public'] || "public";
var libs = commander.libs || "javascripts/libs";
var scripts = commander.scripts || "javascripts/scripts";
var tests = commander.tests || "javascripts/tests";
var reports = commander.reports || "reports";
var baseurl = commander.baseurl || "http://localhost:3000";

commander
	.command('report')
	.action(function(){
		lib.generateReports({
			"public": public,
			"libs": libs,
			"scripts": scripts,
			"tests": tests,
			"reports": reports,
			"baseurl": baseurl
		});
	});


commander
	.command('test')
	.action(function(){
		lib.generateFile({
			instrument: true,
			folders: {
				"public": public,
				"libs": libs,
				"scripts": scripts,
				"tests": tests,
			}
		});

		require('open')(baseurl + '/temp/index.html');
	});
